<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jiin.admin.mapper.data.MapMapper">
    <select id="findAll" resultType="MapDTO">
        SELECT * FROM _MAP
    </select>

    <select id="findByPageModel" resultType="MapDTO">
        SELECT * FROM _MAP M
        <where>
            <choose>
                <when test='sb == 1'> M.NAME LIKE CONCAT('%', #{st}, '%') </when>
                <when test='sb == 2'> M.REGISTOR_ID LIKE CONCAT('%', #{st}, '%') </when>
                <when test='sb == 3'> LOWER(M.PROJECTION) LIKE CONCAT('%', #{st}, '%') </when>
                <otherwise> 1=1 </otherwise>
            </choose>
            <if test="iType != 'ALL'">
                AND M.IMAGE_TYPE = #{iType}
            </if>
            <if test="units != 'ALL'">
                AND M.UNITS = #{units}
            </if>
            <if test="sDate != null and !sDate.equals('') and eDate != null and !eDate.equals('')">
                AND M.REGIST_TIME BETWEEN TO_TIMESTAMP(#{sDate}, 'YYYY-MM-DD') AND TO_TIMESTAMP(#{eDate}, 'YYYY-MM-DD')
            </if>
        </where>
        ORDER BY
        <choose>
            <when test="ob == 1">M.ID ASC</when>
            <when test="ob == 2">M.NAME ASC</when>
            <when test="ob == 3">M.REGIST_TIME DESC</when>
            <otherwise>M.ID DESC</otherwise>
        </choose>
    </select>

    <select id="findByName" resultType="MapDTO">
        SELECT * FROM _MAP WHERE NAME = #{name}
    </select>
</mapper>
